<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Algorithms Project 01, Team Camaro: CImg-2.9.5_pre122220/plugins/chlpca.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Algorithms Project 01, Team Camaro
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('chlpca_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">chlpca.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="chlpca_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> #</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> #  File        : chlpca.cpp</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> #                ( C++ source file )</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> #</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> #  Description : Example of use for the CImg plugin &#39;plugins/chlpca.h&#39;.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> #                This file is a part of the CImg Library project.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> #                ( http://cimg.eu )</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> #</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> #  Copyright  : Jerome Boulanger</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> #               ( http://www.irisa.fr/vista/Equipe/People/Jerome.Boulanger.html )</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> #</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> #</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> #  License     : CeCILL v2.0</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> #                ( http://www.cecill.info/licences/Licence_CeCILL_V2-en.html )</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> #</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> #  This software is governed by the CeCILL  license under French law and</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> #  abiding by the rules of distribution of free software.  You can  use,</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> #  modify and/ or redistribute the software under the terms of the CeCILL</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> #  license as circulated by CEA, CNRS and INRIA at the following URL</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> #  &quot;http://www.cecill.info&quot;.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> #</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> #  As a counterpart to the access to the source code and  rights to copy,</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> #  modify and redistribute granted by the license, users are provided only</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> #  with a limited warranty  and the software&#39;s author,  the holder of the</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> #  economic rights,  and the successive licensors  have only  limited</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> #  liability.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> #</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> #  In this respect, the user&#39;s attention is drawn to the risks associated</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> #  with loading,  using,  modifying and/or developing or reproducing the</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> #  software by the user in light of its specific status of free software,</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> #  that may mean  that it is complicated to manipulate,  and  that  also</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> #  therefore means  that it is reserved for developers  and  experienced</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> #  professionals having in-depth computer knowledge. Users are therefore</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> #  encouraged to load and test the software&#39;s suitability as regards their</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> #  requirements in conditions enabling the security of their systems and/or</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> #  data to be ensured and,  more generally, to use and operate it in the</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> #  same conditions as regards security.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> #</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> #  The fact that you are presently reading this means that you have had</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> #  knowledge of the CeCILL license and that you accept its terms.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> #</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#ifndef cimg_plugin_chlpca</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#define cimg_plugin_chlpca</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// Define some useful macros.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#define cimg_for_step1(bound,i,step) for (int i = 0; i&lt;(int)(bound); i+=step)</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="chlpca_8h.html#a6b027374f8af7aa53bf3b5a703c48899">   52</a></span>&#160;<span class="preprocessor">#define cimg_for_stepX(img,x,step) cimg_for_step1((img)._width,x,step)</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="chlpca_8h.html#a4b2922367684d1deeb8c06b42d2661dc">   53</a></span>&#160;<span class="preprocessor">#define cimg_for_stepY(img,y,step) cimg_for_step1((img)._height,y,step)</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="chlpca_8h.html#a4ddf7ef7fe5454dbcc9e0948409ea50b">   54</a></span>&#160;<span class="preprocessor">#define cimg_for_stepZ(img,z,step) cimg_for_step1((img)._depth,z,step)</span></div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="chlpca_8h.html#a3e56ca52e755fd59496f27094010eedf">   55</a></span>&#160;<span class="preprocessor">#define cimg_for_stepXY(img,x,y,step) cimg_for_stepY(img,y,step) cimg_for_stepX(img,x,step)</span></div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="chlpca_8h.html#adc3346f74450a03e375ccc5d537c6109">   56</a></span>&#160;<span class="preprocessor">#define cimg_for_stepXYZ(img,x,y,step) cimg_for_stepZ(img,z,step) cimg_for_stepY(img,y,step) cimg_for_stepX(img,x,step)</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="chlpca_8h.html#a5026539774accb2fea1bc9420d8bd833">   57</a></span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#define cimg_forXY_window(img,xi,yi,xj,yj,rx,ry)                        \</span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="chlpca_8h.html#a3138dfdae3384066bf8961731e494128">   65</a></span>&#160;<span class="preprocessor">for (int yi0 = std::max(0,yi-ry), yi1=std::min(yi + ry,(int)img.height() - 1), yj=yi0;yj&lt;=yi1;++yj) \</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">for (int xi0 = std::max(0,xi-rx), xi1=std::min(xi + rx,(int)img.width() - 1), xj=xi0;xj&lt;=xi1;++xj)</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#define cimg_forXYZ_window(img,xi,yi,zi,xj,yj,zj,rx,ry,rz)                                      \</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="chlpca_8h.html#a82f95af019eb719729e0d9b54e724424">   69</a></span>&#160;<span class="preprocessor">for (int zi0 = std::max(0,zi-rz), zi1=std::min(zi + rz,(int)img.depth() - 1) , zj=zi0;zj&lt;=zi1;++zj) \</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">for (int yi0 = std::max(0,yi-ry), yi1=std::min(yi + ry,(int)img.height() - 1), yj=yi0;yj&lt;=yi1;++yj) \</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">for (int xi0 = std::max(0,xi-rx), xi1=std::min(xi + rx,(int)img.width() - 1) , xj=xi0;xj&lt;=xi1;++xj)</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="chlpca_8h.html#aef5501adc515779834b5303323b7d4e8">   83</a></span>&#160;CImg&lt;T&gt; <a class="code" href="chlpca_8h.html#aef5501adc515779834b5303323b7d4e8">get_patch</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> z,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                  <span class="keywordtype">int</span> px, <span class="keywordtype">int</span> py, <span class="keywordtype">int</span> pz)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (depth() == 1){</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> x0 = x - px, y0 = y - py, x1 = x + px, y1 = y + py;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">return</span> get_crop(x0, y0, x1, y1).unroll(<span class="charliteral">&#39;y&#39;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      x0 = x - px, y0 = y - py, z0 = z - pz,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      x1 = x + px, y1 = y + py, z1 = z + pz;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">return</span> get_crop(x0, y0, z0, x1, y1, z1).unroll(<span class="charliteral">&#39;y&#39;</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="chlpca_8h.html#a06e87e471720b7e90c8f5150e44afab7">   97</a></span>&#160;CImg&lt;T&gt; <a class="code" href="chlpca_8h.html#a06e87e471720b7e90c8f5150e44afab7">get_patch_dictionnary</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> xi, <span class="keyword">const</span> <span class="keywordtype">int</span> yi, <span class="keyword">const</span> <span class="keywordtype">int</span> zi,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">int</span> px, <span class="keyword">const</span> <span class="keywordtype">int</span> py, <span class="keyword">const</span> <span class="keywordtype">int</span> pz,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">int</span> wx, <span class="keyword">const</span> <span class="keywordtype">int</span> wy, <span class="keyword">const</span> <span class="keywordtype">int</span> wz,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                              <span class="keywordtype">int</span> &amp; idc)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    n = (2*wx + 1) * (2*wy + 1) * (2 * (depth()==1?0:wz) + 1),</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    d = (2*px + 1) * (2*py + 1) * (2 * (depth()==1?0:px) + 1) * spectrum();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  CImg&lt;&gt; S(n, d);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">int</span> idx = 0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">if</span> (depth() == 1) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="chlpca_8h.html#a3138dfdae3384066bf8961731e494128">cimg_forXY_window</a>((*<span class="keyword">this</span>), xi, yi, xj, yj, wx, wy){</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      CImg&lt;T&gt; patch = <a class="code" href="chlpca_8h.html#aef5501adc515779834b5303323b7d4e8">get_patch</a>(xj, yj, 0, px, py, 1);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="CImg_8h.html#a256fd29dc95b642e5c6386e99b0d5593">cimg_forY</a>(S,y) S(idx,y) = patch(y);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">if</span> (xj==xi &amp;&amp; yj==yi) idc = idx;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      idx++;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  } <span class="keywordflow">else</span>  {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="chlpca_8h.html#a82f95af019eb719729e0d9b54e724424">cimg_forXYZ_window</a>((*<span class="keyword">this</span>), xi,yi,zi,xj,yj,zj,wx,wy,wz){</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      CImg&lt;T&gt; patch = <a class="code" href="chlpca_8h.html#aef5501adc515779834b5303323b7d4e8">get_patch</a>(xj, yj, zj, px, py, pz);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <a class="code" href="CImg_8h.html#a256fd29dc95b642e5c6386e99b0d5593">cimg_forY</a>(S,y) S(idx,y) = patch(y);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordflow">if</span> (xj==xi &amp;&amp; yj==yi &amp;&amp; zj==zi) idc = idx;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      idx++;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  S.columns(0, idx - 1);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">return</span> S;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="chlpca_8h.html#a019792bf44123e5f3e2c5cbe0b737ab8">  135</a></span>&#160;CImg&lt;T&gt; &amp; <a class="code" href="chlpca_8h.html#a019792bf44123e5f3e2c5cbe0b737ab8">add_patch</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> xi, <span class="keyword">const</span> <span class="keywordtype">int</span> yi, <span class="keyword">const</span> <span class="keywordtype">int</span> zi,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                    <span class="keyword">const</span> CImg&lt;T&gt; &amp; patch,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> px, <span class="keyword">const</span> <span class="keywordtype">int</span> py, <span class="keyword">const</span> <span class="keywordtype">int</span> pz) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    x0 = xi - px, y0 = yi - py, z0 = (depth() == 1 ? 0 : zi - pz),</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    sx = 2 * px + 1, sy = 2 * py + 1, sz = (depth() == 1 ? 1 : 2 * pz +1);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  draw_image(x0, y0, z0, 0, patch.get_resize(sx, sy, sz, spectrum(), -1), -1);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">return</span> (*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="chlpca_8h.html#acd4e692c7e785c7fa573b654744129d0">  155</a></span>&#160;CImg&lt;T&gt; &amp; <a class="code" href="chlpca_8h.html#a019792bf44123e5f3e2c5cbe0b737ab8">add_patch</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> xi, <span class="keyword">const</span> <span class="keywordtype">int</span> yi, <span class="keyword">const</span> <span class="keywordtype">int</span> zi, <span class="keyword">const</span> T <a class="code" href="Licence__CeCILL-C__V1-en_8txt.html#a306f2ebaa8b02b4067e5f5df297893ec">value</a>,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> px, <span class="keyword">const</span> <span class="keywordtype">int</span> py, <span class="keyword">const</span> <span class="keywordtype">int</span> pz) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    x0 = xi - px, y0 = yi - py, z0 = (depth() == 1 ? 0 : zi - pz),</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    x1 = xi + px, y1 = yi + py, z1 = (depth() == 1 ? 0 : zi + pz);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  draw_rectangle(x0, y0, z0, 0, x1, y1, z1, spectrum()-1, <a class="code" href="Licence__CeCILL-C__V1-en_8txt.html#a306f2ebaa8b02b4067e5f5df297893ec">value</a>, -1);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keywordflow">return</span> (*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="chlpca_8h.html#a33304fcab700ab713989b05af52a4f5a">  179</a></span>&#160;CImg&lt;T&gt; <a class="code" href="chlpca_8h.html#a33304fcab700ab713989b05af52a4f5a">get_chlpca</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> px, <span class="keyword">const</span> <span class="keywordtype">int</span> py, <span class="keyword">const</span> <span class="keywordtype">int</span> pz,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">int</span> wx, <span class="keyword">const</span> <span class="keywordtype">int</span> wy, <span class="keyword">const</span> <span class="keywordtype">int</span> wz,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">int</span> nstep, <span class="keyword">const</span> <span class="keywordtype">float</span> nsim,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">float</span> lambda_min, <span class="keyword">const</span> <span class="keywordtype">float</span> threshold,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">float</span> noise_std,  <span class="keyword">const</span> <span class="keywordtype">bool</span> pca_use_svd)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    nd = (2*px + 1) * (2*py + 1) * (depth()==1?1:2*pz + 1) * spectrum(),</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    K = (int)(nsim * nd);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  fprintf(stderr,<span class="stringliteral">&quot;chlpca: p:%dx%dx%d,w:%dx%dx%d,nd:%d,K:%d\n&quot;</span>,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          2*px + 1,2*py + 1,2*pz + 1,2*wx + 1,2*wy + 1,2*wz + 1,nd,K);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordtype">float</span> sigma;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordflow">if</span> (noise_std&lt;0) sigma = (float)std::sqrt(variance_noise());</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">else</span> sigma = noise_std;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  CImg&lt;T&gt; dest(*<span class="keyword">this</span>), count(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  dest.fill(0);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  count.fill(0);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <a class="code" href="chlpca_8h.html#a3e56ca52e755fd59496f27094010eedf">cimg_for_stepZ</a>(*<span class="keyword">this</span>,zi,(depth()==1||pz==0)?1:nstep){</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">#ifdef cimg_use_openmp</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="CImg_8h.html#acd44207c5029f20ae47c0027947eb92f">cimg_pragma_openmp</a>(parallel <span class="keywordflow">for</span>)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="chlpca_8h.html#adc3346f74450a03e375ccc5d537c6109">cimg_for_stepXY</a>((*<span class="keyword">this</span>),xi,yi,nstep){</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="comment">// extract the training region X</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordtype">int</span> idc = 0;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      CImg&lt;T&gt; S = <a class="code" href="chlpca_8h.html#a06e87e471720b7e90c8f5150e44afab7">get_patch_dictionnary</a>(xi,yi,zi,px,py,pz,wx,wy,wz,idc);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="comment">// select the K most similar patches within the training set</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      CImg&lt;T&gt; Sk(S);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      CImg&lt;unsigned int&gt; a_index(S.width());</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordflow">if</span> (K &lt; Sk.width() - 1){</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        CImg&lt;T&gt; mse(S.width());</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        CImg&lt;unsigned int&gt; perms;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="CImg_8h.html#a0a5ecd92a469bb4a10bda4877d4e0f8d">cimg_forX</a>(S,x) { mse(x) = (T)S.get_column(idc).MSE(S.get_column(x)); }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        mse.sort(perms,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <a class="code" href="CImg_8h.html#a23b58290fee3439000c7e05bb305362f">cimg_foroff</a>(perms,i) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <a class="code" href="CImg_8h.html#a256fd29dc95b642e5c6386e99b0d5593">cimg_forY</a>(S,j) Sk(i,j) = S(perms(i),j);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          a_index(perms(i)) = i;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        Sk.columns(0, K);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        perms.threshold(K);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <a class="code" href="CImg_8h.html#a23b58290fee3439000c7e05bb305362f">cimg_foroff</a>(a_index,i) a_index(i)=i;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="comment">// centering the patches</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      CImg&lt;T&gt; M(1, Sk.height(), 1, 1, 0);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <a class="code" href="CImg_8h.html#ae436e56b67aedb7dece775e090f5f451">cimg_forXY</a>(Sk,x,y) { M(y) += Sk(x,y); }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      M /= (T)Sk.width();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <a class="code" href="CImg_8h.html#ae436e56b67aedb7dece775e090f5f451">cimg_forXY</a>(Sk,x,y) { Sk(x,y) -= M(y); }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="comment">// compute the principal component of the training set S</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      CImg&lt;T&gt; P, lambda;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordflow">if</span> (pca_use_svd) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        CImg&lt;T&gt; V;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        Sk.get_transpose().SVD(V,lambda,P,<span class="keyword">true</span>,100);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        (Sk * Sk.get_transpose()).symmetric_eigen(lambda, P);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        lambda.sqrt();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">// dimension reduction</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordtype">int</span> s = 0;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keyword">const</span> T tx = (T)(std::sqrt((<span class="keywordtype">double</span>)Sk.width()-1.0) * lambda_min * sigma);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordflow">while</span>((lambda(s) &gt; tx) &amp;&amp; (s &lt; ((<span class="keywordtype">int</span>)lambda.size() - 1))) { s++; }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      P.columns(0,s);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="comment">// project all the patches on the basis (compute scalar product)</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      Sk = P.get_transpose() * Sk;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="comment">// threshold the coefficients</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">if</span> (threshold &gt; 0) { Sk.threshold(threshold, 1); }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="comment">// project back to pixel space</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      Sk =  P * Sk;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="comment">// recenter the patches</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <a class="code" href="CImg_8h.html#ae436e56b67aedb7dece775e090f5f451">cimg_forXY</a>(Sk,x,y) { Sk(x,y) += M(y); }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordtype">int</span> j = 0;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <a class="code" href="chlpca_8h.html#a82f95af019eb719729e0d9b54e724424">cimg_forXYZ_window</a>((*<span class="keyword">this</span>),xi,yi,zi,xj,yj,zj,wx,wy,wz){</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = a_index(j);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &lt; Sk.width()) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          dest.add_patch(xj, yj, zj, Sk.get_column(<span class="keywordtype">id</span>), px, py, pz);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;          count.add_patch(xj, yj, zj, (T)1, px, py, pz);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        j++;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <a class="code" href="CImg_8h.html#a23b58290fee3439000c7e05bb305362f">cimg_foroff</a>(dest, i) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span>(count(i) != 0) { dest(i) /= count(i); }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">else</span> { dest(i) = (*this)(i); }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">return</span> dest;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;}</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="chlpca_8h.html#a362ae0a448d7c311a4393e659553609b">  283</a></span>&#160;CImg&lt;T&gt; &amp; <a class="code" href="chlpca_8h.html#a362ae0a448d7c311a4393e659553609b">chlpca</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> px, <span class="keyword">const</span> <span class="keywordtype">int</span> py, <span class="keyword">const</span> <span class="keywordtype">int</span> pz,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">int</span> wx, <span class="keyword">const</span> <span class="keywordtype">int</span> wy, <span class="keyword">const</span> <span class="keywordtype">int</span> wz,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">int</span> nstep, <span class="keyword">const</span> <span class="keywordtype">float</span> nsim,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">float</span> lambda_min, <span class="keyword">const</span> <span class="keywordtype">float</span> threshold,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">float</span> noise_std,  <span class="keyword">const</span> <span class="keywordtype">bool</span> pca_use_svd)  {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  (*this) = <a class="code" href="chlpca_8h.html#a33304fcab700ab713989b05af52a4f5a">get_chlpca</a>(px, py, pz, wx, wy, wz, nstep, nsim, lambda_min,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                               threshold, noise_std, pca_use_svd);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">return</span> (*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="chlpca_8h.html#a025d41f8bc6ba39e21a0c577da597e95">  304</a></span>&#160;CImg&lt;T&gt; <a class="code" href="chlpca_8h.html#a33304fcab700ab713989b05af52a4f5a">get_chlpca</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p=3, <span class="keyword">const</span> <span class="keywordtype">int</span> w=10,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">int</span> nstep=5, <span class="keyword">const</span> <span class="keywordtype">float</span> nsim=10,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">float</span> lambda_min=2, <span class="keyword">const</span> <span class="keywordtype">float</span> threshold = -1,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">float</span> noise_std=-1, <span class="keyword">const</span> <span class="keywordtype">bool</span> pca_use_svd=<span class="keyword">true</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">if</span> (depth()==1) <span class="keywordflow">return</span> <a class="code" href="chlpca_8h.html#a33304fcab700ab713989b05af52a4f5a">get_chlpca</a>(p, p, 0, w, w, 0, nstep, nsim, lambda_min,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                    threshold, noise_std, pca_use_svd);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="chlpca_8h.html#a33304fcab700ab713989b05af52a4f5a">get_chlpca</a>(p, p, p, w, w, w, nstep, nsim, lambda_min,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                         threshold, noise_std, pca_use_svd);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="chlpca_8h.html#a285f15d7dcbc00e4993d472d54954cf4">  314</a></span>&#160;CImg&lt;T&gt; <a class="code" href="chlpca_8h.html#a362ae0a448d7c311a4393e659553609b">chlpca</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p=3, <span class="keyword">const</span> <span class="keywordtype">int</span> w=10,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> nstep=5, <span class="keyword">const</span> <span class="keywordtype">float</span> nsim=10,</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">float</span> lambda_min=2, <span class="keyword">const</span> <span class="keywordtype">float</span> threshold = -1,</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">float</span> noise_std=-1, <span class="keyword">const</span> <span class="keywordtype">bool</span> pca_use_svd=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  (*this) = <a class="code" href="chlpca_8h.html#a33304fcab700ab713989b05af52a4f5a">get_chlpca</a>(p, w, nstep, nsim, lambda_min,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                       threshold, noise_std, pca_use_svd);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">return</span> (*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;}</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* cimg_plugin_chlpca */</span><span class="preprocessor"></span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="achlpca_8h_html_a362ae0a448d7c311a4393e659553609b"><div class="ttname"><a href="chlpca_8h.html#a362ae0a448d7c311a4393e659553609b">chlpca</a></div><div class="ttdeci">CImg&lt; T &gt; &amp; chlpca(const int px, const int py, const int pz, const int wx, const int wy, const int wz, const int nstep, const float nsim, const float lambda_min, const float threshold, const float noise_std, const bool pca_use_svd)</div><div class="ttdoc">CHLPCA denoising from the PhD thesis of Hu Haijuan.</div><div class="ttdef"><b>Definition:</b> chlpca.h:283</div></div>
<div class="ttc" id="aCImg_8h_html_a23b58290fee3439000c7e05bb305362f"><div class="ttname"><a href="CImg_8h.html#a23b58290fee3439000c7e05bb305362f">cimg_foroff</a></div><div class="ttdeci">#define cimg_foroff(img, off)</div><div class="ttdef"><b>Definition:</b> CImg.h:919</div></div>
<div class="ttc" id="achlpca_8h_html_a019792bf44123e5f3e2c5cbe0b737ab8"><div class="ttname"><a href="chlpca_8h.html#a019792bf44123e5f3e2c5cbe0b737ab8">add_patch</a></div><div class="ttdeci">CImg&lt; T &gt; &amp; add_patch(const int xi, const int yi, const int zi, const CImg&lt; T &gt; &amp;patch, const int px, const int py, const int pz)</div><div class="ttdoc">Add a patch to the image.</div><div class="ttdef"><b>Definition:</b> chlpca.h:135</div></div>
<div class="ttc" id="aCImg_8h_html_a256fd29dc95b642e5c6386e99b0d5593"><div class="ttname"><a href="CImg_8h.html#a256fd29dc95b642e5c6386e99b0d5593">cimg_forY</a></div><div class="ttdeci">#define cimg_forY(img, y)</div><div class="ttdef"><b>Definition:</b> CImg.h:924</div></div>
<div class="ttc" id="achlpca_8h_html_aef5501adc515779834b5303323b7d4e8"><div class="ttname"><a href="chlpca_8h.html#aef5501adc515779834b5303323b7d4e8">get_patch</a></div><div class="ttdeci">CImg&lt; T &gt; get_patch(int x, int y, int z, int px, int py, int pz) const</div><div class="ttdoc">Crop a patch in the image around position x,y,z and return a column vector.</div><div class="ttdef"><b>Definition:</b> chlpca.h:83</div></div>
<div class="ttc" id="aCImg_8h_html_ae436e56b67aedb7dece775e090f5f451"><div class="ttname"><a href="CImg_8h.html#ae436e56b67aedb7dece775e090f5f451">cimg_forXY</a></div><div class="ttdeci">#define cimg_forXY(img, x, y)</div><div class="ttdef"><b>Definition:</b> CImg.h:927</div></div>
<div class="ttc" id="achlpca_8h_html_a33304fcab700ab713989b05af52a4f5a"><div class="ttname"><a href="chlpca_8h.html#a33304fcab700ab713989b05af52a4f5a">get_chlpca</a></div><div class="ttdeci">CImg&lt; T &gt; get_chlpca(const int px, const int py, const int pz, const int wx, const int wy, const int wz, const int nstep, const float nsim, const float lambda_min, const float threshold, const float noise_std, const bool pca_use_svd) const</div><div class="ttdoc">CHLPCA denoising from the PhD thesis of Hu Haijuan.</div><div class="ttdef"><b>Definition:</b> chlpca.h:179</div></div>
<div class="ttc" id="achlpca_8h_html_a3e56ca52e755fd59496f27094010eedf"><div class="ttname"><a href="chlpca_8h.html#a3e56ca52e755fd59496f27094010eedf">cimg_for_stepZ</a></div><div class="ttdeci">#define cimg_for_stepZ(img, z, step)</div><div class="ttdef"><b>Definition:</b> chlpca.h:54</div></div>
<div class="ttc" id="achlpca_8h_html_a3138dfdae3384066bf8961731e494128"><div class="ttname"><a href="chlpca_8h.html#a3138dfdae3384066bf8961731e494128">cimg_forXY_window</a></div><div class="ttdeci">#define cimg_forXY_window(img, xi, yi, xj, yj, rx, ry)</div><div class="ttdoc">Loop for point J(xj,yj) in the neighborhood of a point I(xi,yi) of size (2*rx+1,2*ry+1)</div><div class="ttdef"><b>Definition:</b> chlpca.h:64</div></div>
<div class="ttc" id="aCImg_8h_html_acd44207c5029f20ae47c0027947eb92f"><div class="ttname"><a href="CImg_8h.html#acd44207c5029f20ae47c0027947eb92f">cimg_pragma_openmp</a></div><div class="ttdeci">#define cimg_pragma_openmp(p)</div><div class="ttdef"><b>Definition:</b> CImg.h:305</div></div>
<div class="ttc" id="achlpca_8h_html_adc3346f74450a03e375ccc5d537c6109"><div class="ttname"><a href="chlpca_8h.html#adc3346f74450a03e375ccc5d537c6109">cimg_for_stepXY</a></div><div class="ttdeci">#define cimg_for_stepXY(img, x, y, step)</div><div class="ttdef"><b>Definition:</b> chlpca.h:55</div></div>
<div class="ttc" id="aLicence__CeCILL-C__V1-en_8txt_html_a306f2ebaa8b02b4067e5f5df297893ec"><div class="ttname"><a href="Licence__CeCILL-C__V1-en_8txt.html#a306f2ebaa8b02b4067e5f5df297893ec">value</a></div><div class="ttdeci">to ensure that use of the its intellectual property notices and the fact that it is governed by the Agreement is indicated in a text that is easily specifically from the interface of any Derivative Software The Licensee undertakes not to directly or indirectly infringe the intellectual property rights of the Holder and or Contributors on the Software and to where vis  vis its any and all measures required to ensure respect of said intellectual property rights of the Holder and or Contributors Article RELATED SERVICES Under no circumstances shall the Agreement oblige the Licensor to provide technical assistance or maintenance services for the Software the Licensor is entitled to offer this type of services The terms and conditions of such technical and or such shall be set forth in a separate instrument Only the Licensor offering said maintenance and or technical assistance services shall incur liability therefor any Licensor is entitled to offer to its under its sole a that shall only be binding upon for the redistribution of the Software and or the Modified under terms and conditions that it is free to decide Said and the financial terms and conditions of its shall be subject of a separate instrument executed between the Licensor and the Licensee Article LIABILITY Subject to the provisions of the Licensee shall be entitled to claim compensation for any direct loss it may have suffered from the Software as a result of a fault on the part of the relevant subject to providing evidence thereof The Licensor s liability is limited to the commitments made under this Agreement and shall not be incurred as a result of in ii direct or consequential loss that is suffered by the Licensee due to the use or performance of the any consequential loss In particular the Parties expressly agree that any or all pecuniary or business shall constitute consequential loss and shall not provide entitlement to any or all compensation from the Licensor Article WARRANTY The Licensee acknowledges that the scientific and technical state of the art when the Software was distributed did not enable all possible uses to be tested and nor for the presence of possible defects to be detected In this the Licensee s attention has been drawn to the risks associated with modifying and or developing and reproducing the Software which are reserved for experienced users The Licensee shall be responsible for by any or all the suitability of the product for its its good working and for ensuring that it shall not cause damage to either persons or properties The Licensor hereby in good that it is entitled to grant all the rights over the other than that provided for in Article in without any warranty as to its commercial value</div><div class="ttdef"><b>Definition:</b> Licence_CeCILL-C_V1-en.txt:400</div></div>
<div class="ttc" id="achlpca_8h_html_a82f95af019eb719729e0d9b54e724424"><div class="ttname"><a href="chlpca_8h.html#a82f95af019eb719729e0d9b54e724424">cimg_forXYZ_window</a></div><div class="ttdeci">#define cimg_forXYZ_window(img, xi, yi, zi, xj, yj, zj, rx, ry, rz)</div><div class="ttdef"><b>Definition:</b> chlpca.h:68</div></div>
<div class="ttc" id="aCImg_8h_html_a0a5ecd92a469bb4a10bda4877d4e0f8d"><div class="ttname"><a href="CImg_8h.html#a0a5ecd92a469bb4a10bda4877d4e0f8d">cimg_forX</a></div><div class="ttdeci">#define cimg_forX(img, x)</div><div class="ttdef"><b>Definition:</b> CImg.h:923</div></div>
<div class="ttc" id="achlpca_8h_html_a06e87e471720b7e90c8f5150e44afab7"><div class="ttname"><a href="chlpca_8h.html#a06e87e471720b7e90c8f5150e44afab7">get_patch_dictionnary</a></div><div class="ttdeci">CImg&lt; T &gt; get_patch_dictionnary(const int xi, const int yi, const int zi, const int px, const int py, const int pz, const int wx, const int wy, const int wz, int &amp;idc) const</div><div class="ttdoc">Extract a local patch dictionnary around point xi,yi,zi.</div><div class="ttdef"><b>Definition:</b> chlpca.h:97</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_389a256961c342a30a1021c7d08f4b6d.html">CImg-2.9.5_pre122220</a></li><li class="navelem"><a class="el" href="dir_ecd1557ad840bf0d287b820934125a4a.html">plugins</a></li><li class="navelem"><a class="el" href="chlpca_8h.html">chlpca.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
